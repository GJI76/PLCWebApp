define(["backbone","rivets","views/item/WidgetMulti","text!./template.js"],function(t,e,i,s){return i.extend({typeID:"Text",categories:["media"],className:"text",template:_.template(s),sources:[],widgetEvents:{"mouseup .detachedEl":"imgMoved","change .displayWidth":"updateDisplay","change .displayFontFamily":"updateDisplay","change .displayFontSize":"updateDisplay","change .displayFontColor":"updateDisplay","change .displayFontItalic":"updateDisplay","change .displayFontBold":"updateDisplay"},initialize:function(t){i.prototype.initialize.call(this,t),this.model.set({ins:[{title:"in",to:"in"},{title:"X Position",to:"left"},{title:"Y Position",to:"top"},{title:"opacity",to:"opacity"}],title:"Text",activeControlParameter:"left",controlParameters:[{name:"X",parameter:"left"},{name:"Y",parameter:"top"},{name:"opacity",parameter:"opacity"}],appendText:!1,left:250,top:200,opacity:100,displayWidth:500,displayFont:"Arial, Helvetica, sans-serif",displayFontSize:"30px",displayFontColor:"#000000",displayFontItalic:!1,displayFontBold:!1,displayClass:"displaytext",displayClassLast:"displaytext","in":"Populus uxor antehabeo validus turpis dignissim verto si consequat quadrum."}),this.domReady=!1,this.lastIn=-1},onRender:function(){i.prototype.onRender.call(this),app.server||(this.$(".detachedEl").css("cursor","move"),this.$(".detachedEl").css("position","fixed"),this.$(".detachedEl").draggable({cursor:"move"}),this.textDiv=this.$(".displaytext"),this.domReady=!0,this.updateDisplay())},onModelChange:function(t){if(!app.server&&(void 0!==t.changedAttributes().in&&t.changedAttributes().in!=this.lastIn&&(this.model.get("appendText")?this.model.set("displayText",this.model.get("displayText")+" "+this.model.get("in")):this.model.set("displayText",this.model.get("in"))),this.lastIn=t.changedAttributes().in,void 0!==t.changedAttributes().displayClass&&this.domReady)){var e=this.model.get("displayClassLast"),i=this.model.get("displayClass");this.textDiv.removeClass(e).addClass(i),this.model.set("displayClassLast",i)}},updateDisplay:function(){if(!app.server){{var t="normal",e="normal";"."+this.model.get("displayClass")}this.model.get("displayFontItalic")&&(e="italic"),this.model.get("displayFontBold")&&(t="bold"),this.$(".detachedEl").css("width",this.model.get("displayWidth")),this.textDiv.css("font-family",this.model.get("displayFont")),this.textDiv.css("font-size",this.model.get("displayFontSize")),this.textDiv.css("font-style",e),this.textDiv.css("font-weight",t),this.textDiv.css("color",this.model.get("displayFontColor"))}},imgMoved:function(){var t=this.$(".detachedEl").offset();this.model.set("left",t.left),this.model.set("top",t.top)}})});