define(["backbone","rivets","views/item/WidgetMulti","text!./template.js","utils/SignalChainFunctions","utils/SignalChainClasses"],function(e,t,i,n,o){return i.extend({ins:[],outs:[{title:"out",from:"in",to:"out"}],widgetEvents:{},typeID:"OSCIn",deviceMode:"in",className:"oscIn",categories:["Network"],template:_.template(n),initialize:function(e){i.prototype.initialize.call(this,e),this.model.set({title:"OSCIn",messageName:"/ntk/in/1"}),this.signalChainFunctions.push(o.scale),window.app.timingController.registerFrameCallback(this.processSignalChain,this),this.model.on("change",function(e){var t=e.changedAttributes();if(void 0!==t.messageName){for(var i=this.sources.length-1;i>=0;i--){console.log("changing output");var n=e.get("messageName");this.sources[i].map.sourceField=n,this.model.set("outputMapping",n)}window.app.vent.trigger("updateModelMappings",window.app.Patcher.Controller.widgetMappings)}},this),window.setTimeout(function(){window.app.vent.trigger("Widget:hardwareSwitch",{deviceType:"OSC",mode:"in",port:this.model.get("outputMapping")})}.bind(this),200)},onRender:function(){i.prototype.onRender.call(this);this.$(".dial").knob({fgColor:"#000000",bgColor:"#ffffff",inputColor:"#000000",angleOffset:-125,angleArc:250,width:80,height:62,font:"'Helvetica Neue', sans-serif",displayInput:!1,min:0,max:1023,change:function(e){this.model.set("in",parseInt(e))}.bind(this)}),t.binders.knob=function(e,t){e.value=t,$(e).val(t),$(e).trigger("change")}},onModelChange:function(e){for(var t=e.changedAttributes().outputMapping,i=this.sources.length-1;i>=0;i--)this.syncWithSource(this.sources[i].model);if(t)for(var i=this.sources.length-1;i>=0;i--)for(var n in t)window.app.vent.trigger("Widget:hardwareSwitch",{deviceType:this.sources[i].model.get("type"),port:n,mode:this.deviceMode})}})});