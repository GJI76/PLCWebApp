define(["application"],function(){var e=function(e){this.serverAddress=e.serverAddress,this.addFunction=e.addFunction,this.mapFunction=e.mapFunction};return e.prototype={save:function(){},loadJSON:function(e,n){var t=JSON.parse(e),i=t.widgets,o=t.mappings,r=[];n?window.app.vent.trigger("savePatchToServer",{collection:i,mappings:o}):window.app.vent.trigger("loadPatchFileToServer",{widgets:i,mappings:o}),this.largestCID=i.length>0?parseInt(_.map(i,function(e){return e.wid}).sort()[0].slice(1),10):0;for(var a=i.length-1;a>=0;a--){var s=this.addFunction(i[a].typeID,!0,i[a].wid);s.setFromModel(i[a]),r.push(s)}for(var a=o.length-1;a>=0;a--){var d=_.find(r,function(e){return o[a].modelWID==e.model.get("wid")}),p=_.find(r,function(e){return o[a].viewWID==e.model.get("wid")});d&&p?this.mapFunction({model:d.model,IOMapping:o[a].map,view:p,inletOffsets:o[a].offsets,server:window.location.host},!0):this.mapFunction({view:p,modelType:o[a].modelWID,IOMapping:o[a].map,server:window.location.host},!0)}}},e});