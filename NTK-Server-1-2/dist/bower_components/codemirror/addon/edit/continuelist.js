// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE

!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){var n=/^(\s*)(>[> ]*|[*+-]\s|(\d+)([.)]))(\s*)/,t=/^(\s*)(>[> ]*|[*+-]|(\d+)[.)])(\s*)$/,i=/[*+-]\s/;e.commands.newlineAndIndentContinueMarkdownList=function(o){if(o.getOption("disableInput"))return e.Pass;for(var r=o.listSelections(),d=[],l=0;l<r.length;l++){var s=r[l].head,c=o.getStateAfter(s.line),a=c.list!==!1,f=0!==c.quote,u=o.getLine(s.line),p=n.exec(u);if(!r[l].empty()||!a&&!f||!p)return void o.execCommand("newlineAndIndent");if(t.test(u))o.replaceRange("",{line:s.line,ch:0},{line:s.line,ch:s.ch+1}),d[l]="\n";else{var m=p[1],b=p[5],g=i.test(p[2])||p[2].indexOf(">")>=0?p[2]:parseInt(p[3],10)+1+p[4];d[l]="\n"+m+g+b}}o.replaceSelections(d)}});