// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: http://codemirror.net/LICENSE

!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(t,n){var o=t.getModeAt(n),r=o.blockCommentStart,i=o.blockCommentEnd;if(r&&i){for(var f,l=n.line,m=t.getLine(l),a=n.ch,c=0;;){var d=0>=a?-1:m.lastIndexOf(r,a-1);if(-1!=d){if(1==c&&d<n.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(l,d+1)))){f=d+r.length;break}a=d-1}else{if(1==c)return;c=1,a=m.length}}var b,u,g=1,s=t.lastLine();e:for(var h=l;s>=h;++h)for(var k=t.getLine(h),v=h==l?f:0;;){var p=k.indexOf(r,v),C=k.indexOf(i,v);if(0>p&&(p=k.length),0>C&&(C=k.length),v=Math.min(p,C),v==k.length)break;if(v==p)++g;else if(!--g){b=h,u=v;break e}++v}if(null!=b&&(l!=b||u!=f))return{from:e.Pos(l,f),to:e.Pos(b,u)}}})});